
<!DOCTYPE html>
<HTML>
<HEAD>
    <TITLE>
        A Small Hello
    </TITLE>
</HEAD>
<BODY>
    <div id="myDiv"></div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://d3js.org/d3-contour.v1.min.js"></script>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script>
 


        
                
        var myplot = document.getElementById('myDiv')
        
        firsttest(100)
        function firsttest(zoom) {
            var vars = "&zoom=" + zoom

            var request = new XMLHttpRequest();
            request.onreadystatechange = function () {
                if (request.readyState == 4) {
                    res = request.response;
                    act_on_resp(res,zoom);


                }
            }


            request.open('POST', 'http://127.0.0.1:5000/firstzoom');
            request.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
            request.send(vars);
        }
                
           
        function test(zoom,eventdata) {
            var vars = "xcoord=" + eventdata['xaxis.range[0]'] + "&xcoord1=" + eventdata['xaxis.range[1]'] + "&zoom=" + zoom

            var request = new XMLHttpRequest();
            request.onreadystatechange = function () {
                if (request.readyState == 4) {

                    res = request.response;
                    resp = JSON.parse(res);
                    if (resp === undefined || resp.length == 0) {
                        console.log("")
                    }
                    else {
                        act_on_resp(res, zoom);
                    }


                }
            }


            request.open('POST', 'http://127.0.0.1:5000/zoom');
            request.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
            request.send(vars);
        }

        function act_on_resp(resp,zoom) {
            coords = JSON.parse(res);
            console.log(coords)
            console.log(coords["x"])
            

            var data = [{
                z: coords["z"],
                x: coords["x"],
                y: coords["y"],
                type: 'contour'
            }];


            var layout = {
                title: 'Basic Contour Plot'
            }
            console.log(data)
            Plotly.newPlot('myDiv', data, layout);
            myDiv.on('plotly_doubleclick', function () {
                firsttest(100);
                
            });
            myDiv.on('plotly_relayout',
                function (eventdata) {
                    if (zoom - 25 == 0) {
                        test(1, eventdata)
                        return null;
                    }
                    else if (zoom == 1) {
                        console.log("Tester123")
                        return null;
                    }
                    
                 
                       
                        test(zoom - 25, eventdata)
                    
                });
            


        }
        
       
    </script>
    <H1>Hi</H1>
    <P>This is very minimal "hello world" HTML document.</P>

</BODY>
</HTML>